<!doctype html>
<html lang="th">

<head>
  <meta charset="utf-8">
  <title>AlertMalware Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Cache Busting -->
  <link rel="stylesheet"
    href="{{ url_for('admin.static', filename='css/Bootstrap_root.css') }}?v={{ range(1, 999999) | random }}">
  <link rel="stylesheet"
    href="{{ url_for('admin.static', filename='css/bootstrap-icons.css') }}?v={{ range(1, 999999) | random }}">
  <link rel="stylesheet"
    href="{{ url_for('admin.static', filename='css/admin.css') }}?v={{ range(1, 999999) | random }}">
  <link rel="icon" href="{{ url_for('admin.static', filename='favicon.ico') }}">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
</head>

<body>
  <!-- üîπ Login Screen -->
  <div id="login-screen" class="login-container">
    <div class="login-card">
      <img class="login-logo"
        src="{{ url_for('admin.static', filename='assets/image/alertmalware-logo-white.png') }}" alt="logo">
      <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h2>
      <form id="login-form" class="login-form">
        <input type="text" id="username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required>
        <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
        <button type="submit" class="login-btn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        <div id="login-error" class="login-error">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
      </form>
      <div class="login-footer">AlertMalware Admin System</div>
    </div>
  </div>

  <!-- üîπ Admin App -->
  <div id="admin-app" class="admin-app" style="display:none;">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-head">
        <img src="{{ url_for('admin.static', filename='assets/image/alertmalware-logo-white.png') }}" alt="logo">
        <div class="brand">AlertMalware Admin</div>
      </div>

      <ul class="sidebar-nav" id="nav">
        <li data-target="dashboard-section" class="active"><i class="bi bi-speedometer2"></i><span
            class="nav-label">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span></li>
        <li data-target="content-section"><i class="bi bi-journal-text"></i><span
            class="nav-label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</span></li>
        <li data-target="sublessons-section"><i class="bi bi-card-list"></i><span
            class="nav-label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢</span></li>
        <li data-target="lessons-section"><i class="bi bi-collection"></i><span
            class="nav-label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡πà‡∏≤‡∏ô</span></li>
        <li data-target="quiz-section"><i class="bi bi-patch-question"></i><span
            class="nav-label">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</span></li>
        <li data-target="analytics-section"><i class="bi bi-graph-up"></i><span
            class="nav-label">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span></li>
        <li data-target="users-section"><i class="bi bi-people"></i><span class="nav-label">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</span></li>
      </ul>

      <div class="sidebar-footer">
        <button id="logout-btn" class="ghost-btn"><i class="bi bi-box-arrow-right"></i><span
            class="nav-label">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span></button>
      </div>
    </aside>

    <!-- Main -->
    <main class="admin-main">
      <button id="sidebar-toggle" class="primary-btn"><i class="bi bi-layout-sidebar-inset"></i></button>

      <!-- ‚úÖ Dashboard -->
      <section id="dashboard-section">
        <div class="page-header">
          <h1>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö</h1>
          <div class="updated-time">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <span id="dash-updated"></span></div>
        </div>
        <div class="stats-grid" id="dashboard-cards"></div>
        <div class="feed-card">
          <div class="feed-head">Live Activity Feed</div>
          <div class="feed-body" id="recent-activities"></div>
        </div>
      </section>

      <!-- ‚úÖ Content -->
      <section id="content-section" hidden>
        <div class="page-header">
          <h1>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</h1>
        </div>
        <div class="content-layout">
          <aside class="content-sidebar">
            <div class="filter-block">
              <input type="search" id="ct-search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤...">
              <select id="ct-status">
                <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                <option value="draft">Draft</option>
                <option value="published">Published</option>
              </select>
              <button class="primary-btn" id="ct-create"><i class="bi bi-plus-circle"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
            </div>
            <div class="list-block" id="ct-list"></div>
          </aside>

          <div class="content-editor">
            <div class="editor-header">
              <input id="ct-title" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°">
              <input id="ct-slug" placeholder="slug">
              <input id="ct-cover" placeholder="‡∏£‡∏π‡∏õ‡∏õ‡∏Å (URL)">
              <select id="ct-status-edit">
                <option>Draft</option>
                <option>Published</option>
              </select>
              <button id="ct-preview" class="ghost-btn">‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
              <button id="ct-save" class="primary-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>

            <div class="editor-toolbar">
              <button data-cmd="bold">B</button>
              <button data-cmd="italic">I</button>
              <button data-cmd="underline">U</button>
              <button data-cmd="insertUnorderedList">‚Ä¢ List</button>
              <button data-cmd="insertOrderedList">1. List</button>
            </div>
            <div class="editor-surface" id="ct-editor" contenteditable="true"></div>
          </div>
        </div>
      </section>

      <!-- ‚úÖ Sub Lessons -->
      <section id="sublessons-section" hidden>
        <div class="page-header">
          <h1>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢ (Sub Lessons)</h1>
        </div>
        <div class="content-layout">
          <aside class="content-sidebar">
            <div class="filter-block">
              <input type="search" id="sub-search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢...">
              <select id="filter-parent">
                <option value="">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å</option>
              </select>
              <select id="sub-status">
                <option value="">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Published / Draft</option>
                <option value="draft">Draft</option>
                <option value="published">Published</option>
              </select>
              <button class="primary-btn" id="sub-create"><i class="bi bi-plus-circle"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢</button>
            </div>
            <div class="list-block" id="sub-list"></div>
          </aside>

          <div class="content-editor">
            <div class="editor-header">
              <select id="sub-parent">
                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å (parent_slug)</option>
              </select>
              <input id="sub-title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢">
              <input id="sub-slug" placeholder="slug (‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏≠‡∏á)">
              <input id="sub-image" placeholder="URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û">
              <select id="sub-status-edit">
                <option>Published</option>
                <option>Draft</option>
              </select>
              <button id="sub-save" class="primary-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>

            <div class="editor-toolbar">
              <button data-cmd="bold">B</button>
              <button data-cmd="italic">I</button>
              <button data-cmd="underline">U</button>
              <button data-cmd="insertUnorderedList">‚Ä¢ List</button>
              <button data-cmd="insertOrderedList">1. List</button>
            </div>
            <div id="sub-editor" class="editor-surface" contenteditable="true"></div>
          </div>
        </div>
      </section>

      <!-- ‚úÖ Lessons Editor -->
      <section id="lessons-section" hidden>
        <div class="page-header">
          <h1>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡πà‡∏≤‡∏ô (Lessons Editor)</h1>
          <p class="muted">‡πÄ‡∏û‡∏¥‡πà‡∏° / ‡∏•‡∏ö / ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</p>
        </div>

        <div class="content-editor-blocks">
          <div class="toolbar">
            <div class="editor-header">
  <select id="lesson-parent">
    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å (Lesson)</option>
  </select>
  <select id="lesson-sub">
    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢ (Sub Lesson)</option>
  </select>
</div>

            <button id="addTextBlock" class="primary-btn"><i class="bi bi-fonts"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
            <button id="addImageBlock" class="secondary-btn"><i class="bi bi-image"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
            <button id="saveBlocks" class="success-btn"><i class="bi bi-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          </div>

          <div id="blockArea" class="block-area"></div>
        </div>
      </section>

      <!-- ‚úÖ Quiz -->
      <section id="quiz-section" hidden>
        <div class="page-header">
          <h1>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
        </div>
        <div class="card">Coming soon‚Ä¶</div>
      </section>

      <!-- ‚úÖ Analytics -->
      <section id="analytics-section" hidden>
        <div class="page-header">
          <h1>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h1>
        </div>
        <div class="card">Coming soon‚Ä¶</div>
      </section>

      <!-- ‚úÖ Users -->
      <section id="users-section" hidden>
        <div class="page-header">
          <h1>‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h1>
        </div>
        <div class="card">Coming soon‚Ä¶</div>
      </section>
    </main>
  </div>

  <!-- ‚úÖ Block Editor -->
  <link rel="stylesheet"
    href="{{ url_for('admin.static', filename='css/lesson_editor.css') }}?v={{ range(1,999999)|random }}">
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js" defer></script>
  <script src="{{ url_for('admin.static', filename='js/lesson_editor.js') }}?v={{ range(1,999999)|random }}"
    defer></script>

  <!-- ‚úÖ Scripts -->
  <script src="{{ url_for('admin.static', filename='js/admin.js') }}?v={{ range(1,999999)|random }}" defer></script>
  <script src="{{ url_for('admin.static', filename='js/content.js') }}?v={{ range(1,999999)|random }}" defer></script>
  <script src="{{ url_for('admin.static', filename='js/sub_lessons.js') }}?v={{ range(1,999999)|random }}"
    defer></script>

  <!-- ‚úÖ Modal ‡∏•‡∏ö -->
  <div id="delete-modal" class="modal" style="display:none;">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
      </div>
      <div class="modal-body">
        ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô <strong id="delete-lesson-name"></strong> ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
      </div>
      <div class="modal-footer">
        <button id="delete-cancel" class="ghost-btn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button id="delete-confirm" class="danger-btn">‡∏•‡∏ö</button>
      </div>
    </div>
  </div>

  <!-- ‚úÖ Modal ‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏• -->
  <div id="success-modal" class="modal" style="display:none;">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 class="modal-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h3>
      </div>
      <div class="modal-body">
        <p id="success-message"></p>
      </div>
      <div class="modal-footer">
        <button id="success-close" class="primary-btn">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>

  <!-- ‚úÖ Event dispatch ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö content.js -->
  <script>
    document.addEventListener('click', (e) => {
      const li = e.target.closest('li[data-target="content-section"]');
      if (li) {
        document.dispatchEvent(new Event('content-section-opened'));
      }
    });
  </script>
</body>

</html>
